---
title: "esm-206-assignment-5-q4"
author: "Sean Denny"
date: "11/29/2018"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Question 4

```{r load packages and data, message = FALSE}
library(tidyverse)
prof_sal <- read_csv("Faculty salary data (2008 - 2009 survey).csv")
```

Rename discipline column:

```{r}
prof_sal <- prof_sal %>% 
  rename(discipline = "discipline_(A=theoretical_B=applied)")
```

### 1. Explore the data

```{r exploring by grouping/summarizing by explanatory variables, message = FALSE}

#rank

salary_rank <- prof_sal %>% 
  group_by(rank) %>% 
  summarize(
    mean = mean(salary)
)

#As expected.

#discipline; note: A = theoretical, B=applied

salary_discipline <- prof_sal %>% 
  group_by(discipline) %>% 
  summarize(
    mean = mean(salary)
  )

#Average of applied salaries is higher.

#years_since_phd

salary_years_phd <- prof_sal %>% 
  group_by(years_since_phd) %>% 
  summarize(
    mean = mean(salary)
  )

#Generally increases, but not consistent.

#years_faculty

salary_years_faculty <- prof_sal %>% 
  group_by(years_faculty) %>% 
  summarize(
    mean = mean(salary)
  )

#Appears to genereally increase, but not consistent.

#sex

salary_sex <- prof_sal %>% 
  group_by(sex) %>% 
  summarize(
    mean = mean(salary)
  )

#Average of males is higher.

```

### 2. Test for corellations

1. Coerce character variables into factors then numeric (i.e. change the class of the character data)
2. Make sure the levels for each explanatory variable are in the right order. Rearrange them if necessary.
3. Test for correlations among all of the explanatory variables. Can we do this if the variables are factors, or do we absolutely have to change them to numeric? **Create a new dataset without the response variable (salary) so you can run pairs() or cor() for the whole dataset.

```{r testing for correlations}

cor_data <- select(prof_sal, -salary) %>% 
  mutate(rank = as.factor(rank)) %>% 
  mutate(rank = as.numeric(rank)) %>% 
  mutate(discipline = as.factor(discipline)) %>% 
  mutate(discipline = as.numeric(discipline)-1) %>% 
  mutate(sex = as.factor(sex)) %>% 
  mutate(sex = as.numeric(sex)-1)

cor(cor_data)
pairs(cor_data)

#Correlation for years_since_phd and rank = 0.53
#years_since_phd and years_faculty = 0.91

```

### 3. Build the model

We're going to remove years_since_phd, which removes correlations with years_faculty and rank

Use lm() with the following syntax: lm(y ~ x1 + x2 + x3..., data = df_name)

```{r}
prof_lm_1 <- lm(salary ~ sex + discipline + rank + years_since_faculty, data = prof_sal)

```

